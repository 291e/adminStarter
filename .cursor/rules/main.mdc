---
alwaysApply: true
---

### 커서 룰 (Minimal TypeScript v7.3.0 — Starter)

이 문서는 본 리포지토리에서 개발 시 AI 보조 및 팀원이 따라야 할 통합 규칙입니다. `README.md`의 템플릿 사용/수정 가이드와 아래 개발 규칙을 결합해 작성되었습니다. 모든 내용은 한국어 기준이며, 코드 식별자(변수/함수/파일명)는 영문을 사용합니다.

---

## A. 역할/도구/원칙 (팀 공통)

- 역할: React/TypeScript를 주력으로 하는 UX/UI 프론트엔드 개발자. 사려 깊고 섬세한 답변을 제공하며, 높은 추론 능력을 바탕으로 문제를 단계적으로 해결합니다.
- 주요 질의 언어: ReactJS, NextJS, JavaScript, TypeScript, TailwindCSS, MUI, HTML, CSS
- 일반 작업 맥락:
  - Minimal MUI 템플릿(React, Vite, TS, MUI) 편집/확장
  - API는 axios 사용
  - 기존 템플릿을 신속히 커스터마이징하여 납기 단축
- 우선순위 요구사항:
  - 라우팅 구조 및 목업 API 교체를 쉽게 수행할 수 있어야 함
  - Figma 디자인을 MCP로 연동해 픽셀 정확도 높은 구현
- 개발 원칙:
  - 사용자의 요구사항을 신중·정확하게 따르며, 먼저 상세 계획(의사코드) → 확인 → 코드 작성 순으로 진행
  - 정확·최신·버그없음·안전·성능·효율. 단, 성능보다 가독성 우선
  - 요청 기능을 완전 구현. 불필요한 설명 최소화
  - 모르면 추측 대신 모른다고 명시하고 대안을 제시
  - 가능 시 Context7 MCP Server를 활용해 최신 문법/가이드를 반영
  - 간결하고 이해하기 쉬운 코드 지향
  - 반드시 한국어로 커뮤니케이션

---

## 0. 기본 정보 (프로젝트 개요)

- Stack: Vite, React 19, TypeScript, MUI(Emotion), React Router v7
- 진입/라우팅: `src/main.tsx` → `src/routes/sections/*` (Auth/Dashboard)
- 전역 Provider: `src/app.tsx` (Theme/Settings/Auth/ProgressBar)
- 테마: `src/theme/*`, 전역 CSS: `src/global.css`
- 인증(JWT): `src/auth/*` (컨텍스트/가드/유틸)
- 페이지: `src/pages/*`, 레이아웃: `src/layouts/*`
- API 클라이언트: `src/lib/axios.ts` (`CONFIG.serverUrl` 기반)
- 환경변수: 루트 `.env` (예: `VITE_SERVER_URL` 등)
- 빌드/실행
  - 개발: `yarn dev` / `npm run dev`
  - 빌드: `yarn build` / `npm run build`
  - 프리뷰: `yarn start` / `npm run start`
  - 품질: `yarn lint`, `yarn lint:fix`, `yarn fm:check`, `yarn fm:fix`, `yarn tsc:dev`

---

## 1. 프로젝트 구조 (React Router 기준)

- 최상위 라우터: `src/main.tsx`에서 `createBrowserRouter` 구성
- 섹션 라우트: `src/routes/sections/index.tsx`
  - `/`는 `CONFIG.auth.redirectPath`로 리다이렉트
  - `/auth/*`: 게스트 전용 인증 라우트 (`GuestGuard`)
  - `/dashboard/*`: 인증 보호 라우트 (`AuthGuard` + `DashboardLayout`)
- 페이지 파일: `src/pages/**`에 위치, 섹션 라우트에 Lazy 로드로 등록
- 레이아웃: `src/layouts/**`
- 공통 컴포넌트: `src/components/**`
- 테마/설정: `src/theme/**`, `src/components/settings/**`
- 유틸/HTTP: `src/utils/**`, `src/lib/axios.ts`

페이지 추가 절차(예: `/dashboard/seven`):

1. `src/pages/dashboard/seven.tsx` 생성
2. `src/routes/sections/dashboard.tsx`의 `children`에 `{ path: 'seven', element: <PageSeven /> }` 추가
3. 메뉴 노출 시 `src/layouts/nav-config-dashboard.tsx`에 항목 추가

인증 없이 개발하려면 `src/global-config.ts`에서 `auth.skip = true`로 설정합니다.

---

## 2. 네이밍 컨벤션

파일명

- 컴포넌트: `PascalCase.tsx` (예: `LessonCard.tsx`)
- 페이지: `*Page.tsx` 권장 또는 섹션 컨벤션에 맞게 배치 (예: `LessonPage.tsx`)
- 커스텀 훅: `use*.ts` (예: `useAuth.ts`)
- API 서비스: `*.service.ts` (예: `lesson.service.ts`)
- 타입 정의: `*.types.ts`

심볼명

- 컴포넌트: PascalCase (예: `LessonCard`, `MemberInfo`)
- 변수/함수: camelCase (예: `lessonId`, `fetchData`)
- 불린(Boolean): `is`, `has` 접두사 (예: `isActive`, `hasPermission`)
- 이벤트 핸들러: `handle` 접두사 (예: `handleClick`, `handleSubmit`)
- 배열: 복수형 (예: `lessons`, `members`)

---

## 3. 컴포넌트 구조 가이드

권장 구성 순서

1. import 구문(MUI/유틸/타입 분리) → 2) 타입/인터페이스 → 3) 컴포넌트 본문 → 4) 훅 → 5) 핸들러/헬퍼 → 6) JSX 반환 → 7) 스타일(파일 하단)

예시 (Emotion styled 사용):

```tsx
import { useState } from 'react';
import { styled } from '@mui/material/styles';

type LessonCardProps = { title: string };

export default function LessonCard({ title }: LessonCardProps) {
  const [isActive, setIsActive] = useState(false);
  const handleClick = () => setIsActive((v) => !v);
  return (
    <CardContainer onClick={handleClick} data-active={isActive}>
      <h1>{title}</h1>
    </CardContainer>
  );
}

const CardContainer = styled('div')(({ theme }) => ({
  cursor: 'pointer',
  padding: theme.spacing(2),
}));
```

섹션 병합: 하나의 폴더에 여러 섹션을 두고 `index.tsx`에서 Lazy 라우트를 합쳐 사용합니다.

---

## 4. 데이터 페칭 & 상태 관리

서버 상태

- 옵션 1) React Query: 캐싱/재검증/로딩·에러 표준화, `queryKey`는 URL 패턴과 유사하게 구조화: `['lessons', lessonId]`
- 옵션 2) RTK Query: Redux Toolkit 기반 서버 상태. 전역 상태와 일관된 흐름이 필요할 때 권장

클라이언트(앱) 상태

- UI 경량 전역 상태는 RTK 또는 필요 시 최소한의 컨텍스트로 처리

---

## 5. API 통신 규칙

Axios 인스턴스

- `src/lib/axios.ts`의 인스턴스를 사용합니다.
- `baseURL = CONFIG.serverUrl` (환경변수 `VITE_SERVER_URL`로 설정)
- 요청/응답 인터셉터로 토큰 첨부 및 공통 에러 처리 적용 가능

응답 처리

- 백엔드 `BaseResponseDto`에 맞는 타입을 정의해 사용
- UI에서는 React Query의 `isLoading`, `isError`, `data`로 분기 처리

엔드포인트 상수

- `src/lib/axios.ts`의 `endpoints` 사용 (예: `endpoints.auth.signIn`)

목업 API 교체 가이드

- 베이스 URL은 `.env`의 `VITE_SERVER_URL`로 제어 (`CONFIG.serverUrl`)
- 목업 → 실서버 교체 시 체크리스트:
  1. `.env`의 `VITE_SERVER_URL` 변경 후 재시작
  2. `src/lib/axios.ts` 인터셉터에서 토큰/에러 포맷 실서버 스펙에 맞춤
  3. `endpoints` 경로가 백엔드 스펙과 일치하는지 검수
  4. 인증 흐름(`AuthProvider`)의 `/api/auth/me` 응답 스키마 확인 및 타입 보정

---

## 6. 라우팅 규칙

- 라우트는 섹션별 파일에서 Lazy 로드로 선언 (`src/routes/sections/*`)
- 보호 라우트: `AuthGuard` / 게스트 라우트: `GuestGuard`
- 진입 리다이렉트: `CONFIG.auth.redirectPath`

---

## 7. 로깅 및 에러 처리

에러 처리

- React Error Boundary 적용: `src/routes/components/error-boundary.tsx`
- API 에러: React Query의 `isError`/`error` 사용, 사용자 피드백(Toast 등) 제공

---

## 8. 성능 최적화

- 이미지: WebP/AVIF, `<img loading="lazy">` 또는 `<picture>` 활용
- 폰트: `index.html`에 preload 적용 검토
- 코드 분할: `React.lazy` + `Suspense` (본 템플릿 기본 적용)
- 불필요 렌더링 방지: `memo`, `useCallback`, `useMemo`는 필요 시에만 신중히 사용

---

## 9. 테스트 규칙

- 파일명: `*.test.tsx` 또는 `*.spec.tsx`
- Unit/Integration: Jest + React Testing Library
- E2E: Cypress 또는 Playwright
- 구조: Arrange(준비) → Act(실행) → Assert(단언)

---

## 10. 문서화

- README/문서에 변경 사항 반영
- 복잡한 비즈니스 로직/커스텀 훅에는 한글 주석으로 동작/의도 기술

---

## 11. 스타일링 및 환경 설정

스타일링

- Material UI 적극 사용, 테마는 `src/theme/*`에서 관리 (오버라이드/팔레트/타이포 등)
- 런타임 설정 패널: `src/components/settings` (테마/레이아웃 옵션)

코드 포맷팅

- Prettier + ESLint로 일관성 유지 (`yarn lint`, `yarn fm:fix`)

TailwindCSS 사용 지침(선택)

- 프로젝트 컨벤션은 MUI/Emotion 우선이나, 페이지 단위로 Tailwind를 병행할 수 있습니다.
- 유틸리티 클래스 남용을 지양하고 의미 있는 컴포넌트 추상화를 우선합니다.

---

## 12. 특별 규칙

한글 사용

- UI 텍스트/주석은 한글, 코드 식별자는 영문

접근성

- 시맨틱 태그 사용(`<nav>`, `<main>` 등)
- 모든 `<img>`에 의미 있는 `alt` 제공
- 키보드 내비게이션/스크린리더 사용성 고려

---

## 13. 환경 변수 (.env) 요약

- 필수/주요: `VITE_SERVER_URL`, `VITE_ASSETS_DIR(선택)`
- 지도/Firebase/Amplify/Auth0/Supabase 키는 필요 시 설정 (`src/global-config.ts` 참조)

예시

```
VITE_SERVER_URL=https://api-dev-minimal-7.vercel.app
VITE_ASSETS_DIR=""
```

---

## 14. 배포/운영

- 빌드 산출물: `dist/`
- SPA 라우팅 재작성 필요(모든 경로 `index.html`로)
- 환경 변수는 배포 환경에 맞춰 주입

---

## B. 라우팅/목업 API 교체 워크플로우(요약)

1. 라우트 추가

- `src/pages/...` 파일 생성 → `src/routes/sections/*`에 경로 등록 → 필요 시 `src/layouts/nav-config-*.tsx`에 메뉴 추가

2. 목업 → 실서버 전환

- `.env` 교체 → `axios` 인터셉터/에러 처리 조정 → `endpoints` 동기화 → 인증 흐름 검수

3. 인증 우회 개발

- `src/global-config.ts`의 `auth.skip = true`

---

## C. Figma MCP 연동 및 픽셀 퍼펙트 지침

- Figma 연결: MCP 도구를 사용해 디자인 컨텍스트/이미지/코드 스니펫을 가져옵니다.
  - 코드 생성/컨텍스트: `mcp_Figma_get_design_context`
  - 스크린샷: `mcp_Figma_get_screenshot`
  - 메타데이터/변수: `mcp_Figma_get_metadata`, `mcp_Figma_get_variable_defs`
- 구현 원칙
  - 타이포/색상/간격은 `src/theme/*` 토큰으로 매핑
  - 그리드/레이아웃은 MUI Grid/Stack 우선, 필요 시 CSS Grid/Flex 병행
  - 컴포넌트는 재사용 가능하게 분리하고 prop으로 변형 제어
- MUI 문서 참조: MCP MUI Docs 도구를 통해 버전에 맞는 API/Prop 확인 후 사용

---

## D. 제작하고자 하는 사이트 구조

- 공통 섹션
  - Auth: `/auth/jwt/sign-in`, `/auth/jwt/sign-up` (게스트 전용)
  - Dashboard: `/dashboard` 루트 및 하위 그룹 라우트
- 권장 구조 예시
  - `/dashboard` (Index)
  - `/dashboard/two`, `/dashboard/three`
  - `/dashboard/group` (index → four), `/dashboard/group/five`, `/dashboard/group/six`
- 내비게이션

  - `src/layouts/nav-config-*.tsx`에서 메뉴 항목 관리. 새 페이지 추가 시 동기화

- 공통 컴포넌트
  - `src/components/safeyou` 에서 다양한 공통 컴퍼넌트 상황별로 사용
